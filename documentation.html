<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWTKit Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        h1 {
            margin: 0;
        }
        h2 {
            color: #2c3e50;
            padding-bottom: 5px;
            border-bottom: 2px solid #eee;
            margin-top: 30px;
        }
        h3 {
            color: #3498db;
            margin-top: 20px;
        }
        pre {
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f8f8f8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        .endpoint {
            background-color: #e8f4fc;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
        }
        .method {
            font-weight: bold;
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 10px;
        }
        .get {
            background-color: #61affe;
            color: white;
        }
        .post {
            background-color: #49cc90;
            color: white;
        }
        .section {
            margin-bottom: 40px;
        }
        .warning {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>üîê JWTKit Documentation</h1>
        <p>A comprehensive web-based tool for analyzing, testing, and exploiting JWT tokens</p>
    </header>

    <div class="section">
        <h2>Overview</h2>
        <p>
            JWTKit is a powerful JWT (JSON Web Token) analysis and testing tool designed for security professionals,
            penetration testers, and developers. It provides a range of features to help understand, manipulate,
            and test JWT implementations for security vulnerabilities.
        </p>
        <div class="warning">
            <strong>Important:</strong> This tool is for educational and authorized security testing purposes only.
            Only use it against your own applications or systems you have explicit permission to test.
        </div>
    </div>

    <div class="section">
        <h2>Getting Started</h2>

        <h3>Requirements</h3>
        <ul>
            <li>Python 3.8+</li>
            <li>Node.js 14+</li>
            <li>npm or yarn</li>
        </ul>

        <h3>Installation</h3>
        <ol>
            <li>
                <p>Clone the repository:</p>
                <pre><code>git clone https://github.com/yourusername/JWTKit.git
cd JWTKit</code></pre>
            </li>
            <li>
                <p>Set up the backend:</p>
                <pre><code>cd backend
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt</code></pre>
            </li>
            <li>
                <p>Set up the frontend:</p>
                <pre><code>cd ../frontend
npm install</code></pre>
            </li>
            <li>
                <p>Start the development servers:</p>
                <pre><code># Backend (in one terminal)
cd backend
python main.py

# Frontend (in another terminal)
cd frontend
npm start</code></pre>
            </li>
            <li>Open your browser and navigate to <code>http://localhost:3000</code></li>
        </ol>
    </div>

    <div class="section">
        <h2>API Endpoints</h2>
        
        <h3>Basic API Routes</h3>
        
        <div class="endpoint">
            <span class="method get">GET</span> <code>/</code>
            <p>Health check endpoint that returns a status message for the API.</p>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "status": "healthy", 
  "service": "JWTKit API"
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/decode</code>
            <p>Decode a JWT and return its components without verifying the signature.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "header": {
    "alg": "HS256",
    "typ": "JWT"
  },
  "payload": {
    "sub": "1234567890",
    "name": "John Doe",
    "iat": 1516239022
  },
  "signature": "SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
  "is_valid": null
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/verify</code>
            <p>Verify a JWT signature using the provided secret.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
  "secret": "your-256-bit-secret",
  "algorithm": "HS256"  // Optional, defaults to HS256
}</code></pre>
            <p><strong>Response (valid):</strong></p>
            <pre><code>{
  "valid": true,
  "payload": {
    "sub": "1234567890",
    "name": "John Doe",
    "iat": 1516239022
  }
}</code></pre>
            <p><strong>Response (invalid):</strong></p>
            <pre><code>{
  "valid": false,
  "error": "Invalid token: Signature verification failed"
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/vulnerabilities</code>
            <p>Scan a JWT for common vulnerabilities and misconfigurations.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "token_info": {
    "header": {
      "alg": "HS256",
      "typ": "JWT"
    },
    "payload": {
      "sub": "1234567890",
      "name": "John Doe",
      "iat": 1516239022
    }
  },
  "vulnerabilities": [
    {
      "severity": "info",
      "issue": "HMAC Algorithm",
      "description": "The token uses HMAC which might be vulnerable to brute force if a weak secret is used."
    },
    {
      "severity": "medium",
      "issue": "No Expiration",
      "description": "The token does not have an expiration time (exp claim)."
    }
  ],
  "risk_score": 2,
  "recommendations": [
    "Use RS256 instead of HS256 for better security",
    "Always include expiration time (exp) in tokens",
    "Validate issuer and audience claims"
  ]
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/modify</code>
            <p>Modify a JWT payload and re-sign it.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
  "new_payload": {
    "sub": "1234567890",
    "name": "John Doe",
    "role": "admin",
    "iat": 1516239022
  },
  "secret": "your-256-bit-secret",
  "algorithm": "HS256"  // Optional, defaults to original algorithm or HS256
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "modified_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyfQ.9h5Hl8C2iIBJEipSez2L8GrvWH_2MFGGPgfpEuBDy6M",
  "algorithm": "HS256"
}</code></pre>
        </div>

        <h3>Security Testing Routes</h3>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/algorithm-confusion</code>
            <p>Test for algorithm confusion vulnerability (RS256 to HS256).</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",  // An RS256 token
  "public_key": "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...\n-----END PUBLIC KEY-----"
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "success": true,
  "modified_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "attack_type": "Algorithm Confusion (RS256 to HS256)",
  "description": "This attack exploits implementations that don't validate the algorithm type correctly."
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/brute-force</code>
            <p>Attempt to brute force the secret of an HS256 JWT token.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "wordlist": ["password1", "secret", "key123", "password123"]  // Array of potential secrets
}</code></pre>
            <p><strong>Response (success):</strong></p>
            <pre><code>{
  "success": true,
  "secret_found": "secret",
  "decoded_payload": {
    "sub": "1234567890",
    "name": "John Doe",
    "iat": 1516239022
  },
  "message": "Secret found! Token can be forged."
}</code></pre>
            <p><strong>Response (failure):</strong></p>
            <pre><code>{
  "success": false,
  "message": "Secret not found in provided wordlist",
  "words_checked": 4
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/key-injection</code>
            <p>Test for key ID (kid) injection vulnerability.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "kid_value": "../../../dev/null"  // Path to inject in the kid header
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "success": true,
  "forged_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ii4uLy4uLy4uL2Rldi9udWxsIn0...",
  "message": "Key injection attack successful with kid value: ../../../dev/null"
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/jwks-spoofing</code>
            <p>Create a spoofed JWKS and corresponding token.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "success": true,
  "spoofed_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImF0dGFja2VyLWtleS0xNjU0MzIxMDk4In0...",
  "jwks": {
    "keys": [
      {
        "kty": "RSA",
        "kid": "attacker-key-1654321098",
        "use": "sig",
        "n": "sample-n-value",
        "e": "AQAB"
      }
    ]
  },
  "message": "JWKS spoofing example created"
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/token-expiration-bypass</code>
            <p>Demonstrate token expiration bypass techniques.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "success": true,
  "token_with_no_expiration": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_with_extended_expiration": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "message": "Token expiration bypass techniques applied"
}</code></pre>
        </div>
        
        <div class="endpoint">
            <span class="method post">POST</span> <code>/test-endpoint</code>
            <p>Test a JWT against a specified endpoint.</p>
            <p><strong>Request Body:</strong></p>
            <pre><code>{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "url": "https://api.example.com/protected-resource",
  "method": "GET"  // GET, POST, PUT, or DELETE
}</code></pre>
            <p><strong>Response:</strong></p>
            <pre><code>{
  "success": true,
  "status_code": 200,
  "response_headers": {
    "Content-Type": "application/json",
    "Date": "Wed, 01 Jun 2023 12:00:00 GMT"
  },
  "response_text": "{\"message\":\"Resource accessed successfully\"}",
  "message": "Request completed with status code: 200"
}</code></pre>
        </div>
    </div>

    <div class="section">
        <h2>Frontend Components</h2>
        
        <h3>JWT Decoder & Inspector</h3>
        <p>
            Allows you to paste a JWT token and decode it to view the header, payload, and signature.
            This component also highlights important claims like expiration, issued at, and subject.
        </p>
        
        <h3>Signature Verifier</h3>
        <p>
            Verify the signature of a JWT using a provided secret key. Supports various algorithms
            including HS256, HS384, HS512, RS256, ES256, and more.
        </p>
        
        <h3>Vulnerability Scanner</h3>
        <p>
            Scans a JWT for common vulnerabilities and security issues, providing a risk score
            and recommendations for improvement.
        </p>
        
        <h3>Payload Editor</h3>
        <p>
            Edit a JWT's payload and re-sign it with a provided secret key. Useful for testing 
            authorization bypasses and privilege escalation vulnerabilities.
        </p>
        
        <h3>Attack Simulator</h3>
        <p>
            Test various JWT attacks including:
        </p>
        <ul>
            <li>None Algorithm Attack</li>
            <li>Algorithm Confusion Attack</li>
            <li>Secret Brute Force</li>
            <li>KID Header Injection</li>
            <li>JWKS Spoofing</li>
            <li>Expiration Bypass</li>
        </ul>
    </div>

    <div class="section">
        <h2>Security Considerations</h2>
        <div class="warning">
            <p>
                <strong>Educational Purpose Only:</strong> JWTKit is designed for educational purposes and authorized security testing.
                Using these tools against systems without explicit permission may violate laws and policies.
            </p>
            <p>
                <strong>Data Security:</strong> JWTKit is designed to work locally in your browser and server. Sensitive data like tokens
                and keys are not sent to any third-party services. However, you should still be cautious when testing with production credentials.
            </p>
        </div>
    </div>

    <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #eee; text-align: center; color: #777;">
        <p>JWTKit | Created for security research and educational purposes | Copyright &copy; 2023</p>
    </footer>
</body>
</html>